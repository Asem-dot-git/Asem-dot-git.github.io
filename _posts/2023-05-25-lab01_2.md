---
title: "Lab01-2"
classes: wide
header:
  teaser: /assets/images/malware-analysis/pic_1/lab01-1.png
ribbon:
description: "practical Malware Analysis Lab01-1..."
categories:
  - Malware Analysis
toc: true
---

## 1.Upload the Lab01-02.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?
  **55/71 detection rate**

## 2. Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

 there are some indicators like the PEIDshow me the file packed by UPX encryption in section .text like DIE tell me and there are some functions that indicate the packed like:

 ![error](/assets/images/malware-analysis/pic_2/upx_packed.png)


## 3. Do any imports hint at this programâ€™s functionality? If so, which imports are they and what do they tell you?
 By using Dependency Walker I found some DLLs that import some fanctions like 
 ```text
KERNEL32.DLL
    
- SystemTimeToFileTime
- GetModuleFileNameA
- CreateMutexA
- CreateThread
- SetWaitableTimer
```
```text
ADVAPI32.DLL

- CreateServiceA
- StartServiceCtrlDispatcherA
- OpenSCManagerA
```
```text
WININET.DLL
    
- InternetOpenUrlA
- InternetOpenA
```
Based on that the malware create a thread,sevice and communicates over the network.

## 4. What host- or network-based indicators could be used to identify this malware on infected machines?
 Looking at the strings of this file shows 2 interesting strings `malservice` and `http://w`

![error](/assets/images/malware-analysis/pic_2/network_indecator.png)

based on that i guess the malware searching hosts for scheduled sevice called `malsevice` and looking for hosts connection to `http://www.malwareanalysisbook.com` .
